#!/bin/bash
cd $( dirname "${BASH_SOURCE[0]}" )

if [ -z "$SPRITE_HOME" ]; then
  SPRITE_HOME=`realpath ../install`
fi

1>&2 python <<EOF
from __future__ import print_function
text = 'Using SPRITE_HOME=$SPRITE_HOME'
n = len(text) + 16
border = '*' * n
print()
print(border)
print(text.center(n))
print(border)
print()
EOF

if [ ! -d "$SPRITE_HOME" ]; then
  1>&2 echo SPRITE_HOME is not a directory.
  exit 1
fi

export SPRITE_HOME
export PYTHONPATH=`pwd`/lib:$PYTHONPATH
export LD_LIBRARY_PATH=$SPRITE_HOME/lib:$LD_LIBRARY_PATH

case `basename $0` in
  "run_tests")
    python -B -m unittest discover -v `pwd` "$@"
    ;;
  "debug_tests")
    python=`which python`
    python=`readlink -f $python`
    gdb --args $python -B -m unittest discover -v `pwd` "$@"
    ;;
esac

